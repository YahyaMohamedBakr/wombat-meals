{%- style -%}
  .accordion-section-{{ section.id }} {
    padding-top: {{ section.settings.padding_v }}px;
    padding-bottom: {{ section.settings.padding_v }}px;
    background-color: {{ section.settings.bg_color }};
  }
  .accordion-container {
    max-width: 800px; 
    margin: 0 auto;
    padding: 0 20px;
  }
  .accordion-item {
    border: 1px solid #ebebeb; 
    margin-bottom: 0; 
    border-bottom: none;
  }
  .accordion-item:last-child {
    border-bottom: 1px solid #ebebeb;
  }
  .accordion-header {
    display: flex;
    align-items: center;
    padding: 18px 25px;
    cursor: pointer;
    /* background: #fff; */
    transition: all 0.3s;
  }
  .accordion-header:hover {
    background-color:rgba(255, 255, 255, 0);
  }
  .accordion-icon {
    width: 15px;
    height: 15px;
    margin-right: 15px;
    display: flex;
    align-items: center;
    fill: #555;
    transition: transform 0.3s ease;
  }
  .accordion-item.active .accordion-icon {
    transform: rotate(90deg); 
  }
  .accordion-label {
    font-size: 1.1rem;
    font-weight: 500;
    color: #333;
  }
  
  .accordion-content {
    display: none;
    padding: 0; 
    /* background: #fff; */
    border-top: 1px solid #ebebeb;
    max-height: {{ section.settings.max_height }}px; 
    overflow-y: auto; 
  }

  .accordion-content::-webkit-scrollbar {
    width: 6px;
  }
  .accordion-content::-webkit-scrollbar-track {
    background: #f1f1f1;
  }
  .accordion-content::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 10px;
  }

  .accordion-content table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }
  .accordion-content td {
    padding: 12px 20px;
    border-bottom: 1px solid #f2f2f2;
    font-size: 0.9rem;
    color: #666;
  }
  
  .accordion-content thead:first-child tr {
    position: sticky;
    top: 0;
    background: #f9f9f9;
    font-weight: bold;
    color: #333;
    z-index: 10;
    border-bottom: 2px solid #eee;
    text-align:left;
  }
{%- endstyle -%}

<section class="accordion-section-{{ section.id }}">
  <div class="accordion-container">
    {% if section.settings.title != blank %}
      <h2 style="text-align:center; margin-bottom:40px;">{{ section.settings.title }}</h2>
    {% endif %}

    <div class="accordion-wrapper">
      {% for block in section.blocks %}
        <div class="accordion-item {% if forloop.first and section.settings.open_first %}active{% endif %}" {{ block.shopify_attributes }}>
          <div class="accordion-header" onclick="toggleAccordion(this)">
            <span class="accordion-icon">
              <svg viewBox="0 0 192 512"><path d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"></path></svg>
            </span>
            <span class="accordion-label">{{ block.settings.title }}</span>
          </div>
          <div class="accordion-content" style="{% if forloop.first and section.settings.open_first %}display: block;{% endif %}">
             {{ block.settings.content }}
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</section>

<script>
function toggleAccordion(element) {
  const item = element.parentElement;
  const content = element.nextElementSibling;
  const isActive = item.classList.contains('active');

  if (isActive) {
    item.classList.remove('active');
    content.style.display = 'none';
  } else {
    item.classList.add('active');
    content.style.display = 'block';
  }
}
</script>

{% schema %}
{
  "name": "Wombat Accordion Table",
  "settings": [
    { "type": "text", "id": "title", "label": "Main Title", "default": "Our Delivery Areas" },
    { "type": "color", "id": "bg_color", "label": "Background", "default": "#ffffff" },
    { "type": "range", "id": "padding_v", "label": "Vertical Padding", "min": 0, "max": 100, "step": 2, "default": 40 },
    { "type": "range", "id": "max_height", "label": "Table Max Height (Scroll)", "min": 200, "max": 800, "step": 10, "default": 400 },
    { "type": "checkbox", "id": "open_first", "label": "Open first item by default", "default": false }
  ],
  "blocks": [
    {
      "type": "item",
      "name": "Region Table",
      "settings": [
        { "type": "text", "id": "title", "label": "Region Name", "default": "Sydney Metro" },
        { "type": "html", "id": "content", "label": "Table Content", "info": "Paste your table here from Excel/Sheets" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Wombat Accordion Table"
    }
  ]
}
{% endschema %}